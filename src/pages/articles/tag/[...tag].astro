---
import Layout from "../../../layouts/MainLayout.astro"
import {getCollection} from "astro:content"
import type {CollectionEntry} from "astro:content"
import {formatDate} from "../../../utils"
import ArticleCard from "../../../components/ArticleCard.astro"
const {tag} = Astro.params
console.log(tag)
if (tag === undefined){
    throw new Error("Tag is required")
}
const allBlogArticles: CollectionEntry<'blog'>[] = (await getCollection("blog")).sort((a:CollectionEntry<'blog'>, b:CollectionEntry<'blog'>) => {
    return b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
})
const tagArticles = allBlogArticles.filter(article => article.data.tags.includes(tag))
---
<Layout>
    <h1 class="text-2xl pb-3">{tag}</h1>
    <!-- Main Grid -->
    <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
        {tagArticles.map(article=> (
                <ArticleCard article={article} />
        ))}
    </div>

</Layout>